<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head></head>

<body>
<div th:fragment="timeline" class="max-w-4xl mx-auto">
    <div class="text-center mb-12">
        <span class="badge mb-4" th:text="#{experience.badge}">Career Journey</span>
        <h2 id="experience-heading" class="section-title" th:text="#{experience.title}">Work Experience</h2>
        <p class="section-description" th:text="#{experience.description}">
            From hospitality roots to senior engineering roles — every step shaped who I am today.
        </p>
    </div>

    <div class="timeline">
        <div class="timeline-line"></div>
        
        <div th:each="event, iterStat : ${details.events}" 
             class="timeline-item"
             th:classappend="${iterStat.first} ? 'timeline-item-current timeline-item-left' : (${iterStat.even} ? 'timeline-item-right' : 'timeline-item-left')"
             th:attr="data-delay=${iterStat.index * 100}"
             x-data="{ show: false }"
             x-init="setTimeout(() => show = true, $el.dataset.delay)"
             x-bind:class="show ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-8'">
            
            <div class="timeline-marker">
                <div class="timeline-icon-wrapper" th:classappend="${iterStat.first} ? 'timeline-icon-current' : ''">
                    <i th:classappend="${event.icon.classes}" th:style="${event.icon.style}"></i>
                </div>
            </div>

            <div class="relative">
                <div class="inline-block py-1 px-3 text-xs font-semibold text-[var(--color-accent)] bg-[var(--color-accent-subtle)] rounded-full mb-3" th:classappend="${iterStat.first} ? 'timeline-date-current' : ''">
                    <span th:text="${#temporals.format(event.start, 'MM-yyyy') + ' → ' + (event.end != null ? #temporals.format(event.end, 'MM-yyyy') : #messages.msg('timeline.current'))}"></span>
                </div>
                
                <article class="timeline-card" th:classappend="${iterStat.first} ? 'timeline-card-current' : ''">
                    <div class="mb-3">
                        <h3 class="text-lg font-bold text-[var(--color-text-primary)] m-0 mb-1" th:text="${event.jobTitle}"></h3>
                        <p class="text-[0.9375rem] font-medium text-[var(--color-accent)] m-0">
                            <span th:text="${event.employer}"></span>
                        </p>
                    </div>
                    
                    <div class="relative" 
                         x-data="{ expanded: false }"
                         th:with="isLong=${#strings.length(event.description) > 150}">
                        <p class="text-sm text-[var(--color-text-secondary)] leading-relaxed m-0"
                           x-bind:class="!expanded && 'line-clamp-3'"
                           th:text="${event.description}"></p>
                        <button th:if="${isLong}"
                                class="inline-block mt-2 p-0 text-[0.8125rem] font-medium text-[var(--color-accent)] bg-none border-none cursor-pointer transition-colors duration-150 hover:text-[var(--color-accent-hover)]"
                                x-on:click="expanded = !expanded"
                                th:attr="data-show-less=#{experience.show.less},data-read-more=#{experience.read.more}"
                                x-text="expanded ? $el.dataset.showLess : $el.dataset.readMore">
                        </button>
                    </div>
                </article>
            </div>
        </div>
    </div>
</div>
</body>

</html>
